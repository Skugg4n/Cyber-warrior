<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyber Warrior</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-black">
    <div id="root"></div>
    <!-- React and Babel -->
    <script src="https://unpkg.com/react@17/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script type="text/babel">
// --- MOCK DATA ---
// NEW: Replaced placeholder missions with your specific PUSH/PULL/LEGS routines.
const initialOperatorData = {
  id: '#8A5C2F',
  level: 1,
  xp: 0,
  xpToNextLevel: 1000,
  systemIntegrity: '99.8%',
  augments: ['Stock Chassis Mk I'],
};

const missionsData = [
  {
    id: 'mission_push',
    title: 'SYSTEM DIRECTIVE: PUSH PROTOCOL',
    from: 'AEGIS_COMMAND',
    description: '// Execute chest, shoulder, and triceps sub-routines. Focus on controlled power output.',
    reward: '2500 DATA_PACKETS, SCHEMATIC: AEGIS_PAULDRONS_MKII',
    xp: 2500,
    exercises: [
      { id: 'ex_dbp', name: 'Dumbbell Bench Press', targetSets: 3, targetReps: '20-30', previous: '12.5kg x 20-30 reps' },
      { id: 'ex_dssp', name: 'Dumbbell Seated Shoulder Press', targetSets: 3, targetReps: '10-12', previous: '8-12.5kg x 10-12 reps' },
      { id: 'ex_dbalr', name: 'Dumbbell Bent Arm Lateral Raise', targetSets: 3, targetReps: '15-20', previous: '8kg x 15-20 reps' },
      { id: 'ex_dk', name: 'Dumbbell Kickback', targetSets: 4, targetReps: '10-15', previous: '8-12.5kg x 10-15 reps' },
      { id: 'ex_dpu', name: 'Deep Push Up (hands on DBs)', targetSets: 3, targetReps: 'max', previous: 'Body-weight x max reps' },
      { id: 'ex_bbp', name: 'Barbell Bench Press', targetSets: 3, targetReps: '8-10', previous: '50-55kg x 8-10 reps' },
      { id: 'ex_kte', name: 'Kettlebell Triceps Extension', targetSets: 2, targetReps: '10-12', previous: '8-12kg x 10-12 reps' },
    ],
  },
  {
    id: 'mission_pull',
    title: 'SYSTEM DIRECTIVE: PULL PROTOCOL',
    from: 'AEGIS_COMMAND',
    description: '// Execute back and biceps sub-routines. Focus on contractile force.',
    reward: '2200 DATA_PACKETS, SCHEMATIC: MYOMER_CONDUITS_V2',
    xp: 2200,
    exercises: [
        { id: 'ex_dir', name: 'Dumbbell Incline Row', targetSets: 3, targetReps: '15-20', previous: '12.5kg x 15-20 reps' },
        { id: 'ex_bor', name: 'Bent Over Row', targetSets: 3, targetReps: '20-30', previous: '12.5kg x 20-30 reps' },
        { id: 'ex_dashc', name: 'Dumbbell Alternate Seated Hammer Curl', targetSets: 4, targetReps: '15-20', previous: '12.5kg x 15-20 reps' },
        { id: 'ex_ds', name: 'Dumbbell Shrug', targetSets: 3, targetReps: '30-40', previous: '12.5kg x 30-40 reps' },
        { id: 'ex_bor_alt', name: 'Bent-Over Row (barbell / DB alt.)', targetSets: 3, targetReps: '20-25', previous: '12.5kg x 20-25 reps' },
    ],
  },
  {
    id: 'mission_legs_core',
    title: 'SYSTEM DIRECTIVE: LEGS & CORE PROTOCOL',
    from: 'AEGIS_COMMAND',
    description: '// Full system diagnostic. Calibrate foundational and core stability systems.',
    reward: '3000 DATA_PACKETS, SCHEMATIC: GYRO_STABILIZERS_MKIII',
    xp: 3000,
    exercises: [
        { id: 'ex_fs', name: 'Full Squat (barbell)', targetSets: 3, targetReps: '8-10', previous: '50kg x 8-10 reps' },
        { id: 'ex_dl', name: 'Deadlift (conventional)', targetSets: 3, targetReps: '15-16', previous: '50kg x 15-16 reps' },
        { id: 'ex_brdl', name: 'Barbell Romanian Deadlift', targetSets: 3, targetReps: '12-15', previous: '50kg x 12-15 reps' },
        { id: 'ex_gs', name: 'Goblet Squat (KB/DB)', targetSets: 3, targetReps: '15-20', previous: '12.5-16kg x 15-20 reps' },
        { id: 'ex_dlu', name: 'Dumbbell Lunge', targetSets: 3, targetReps: '10-12', previous: '12.5kg x 10-12 reps' },
        { id: 'ex_bscr', name: 'Barbell Standing Calf Raise', targetSets: 3, targetReps: '30-32', previous: '50kg x 30-32 reps' },
        { id: 'ex_dgb', name: 'Dumbbell Glute Bridge', targetSets: 3, targetReps: '20', previous: '12.5-16kg x 20 reps' },
        { id: 'ex_kbs', name: 'Kettlebell Swing', targetSets: 3, targetReps: '20', previous: '16kg x 20 reps' },
        { id: 'ex_wr', name: 'Wheel Rollout', targetSets: 3, targetReps: '10-12', previous: 'Body-weight x 10-12 reps' },
        { id: 'ex_wsltc', name: 'Weighted Straight Leg Toe Touch Crunch', targetSets: 3, targetReps: '20-30', previous: '12.5-16kg x 20-30 reps' },
        { id: 'ex_hlr', name: 'Hanging Leg Raise', targetSets: 3, targetReps: '10', previous: 'Body-weight x 10 reps' },
        { id: 'ex_lrhl', name: 'Leg Raise Hip Lift', targetSets: 3, targetReps: '10-15', previous: 'Body-weight x 10-15 reps' },
        { id: 'ex_su', name: 'Sit-Up', targetSets: 3, targetReps: '30', previous: 'Body-weight x 30 reps' },
        { id: 'ex_krt', name: 'Kettlebell Russian Twist', targetSets: 3, targetReps: '20', previous: '16kg x 20 reps' },
        { id: 'ex_tt', name: 'Toe Touch (body-weight)', targetSets: 3, targetReps: '20', previous: 'Body-weight x 20 reps' },
    ],
  },
    {
    id: 'mission_cond',
    title: 'SYSTEM DIRECTIVE: CONDITIONING & MOBILITY',
    from: 'SYS_MAINTENANCE',
    description: '// Run system optimization and defragmentation protocols.',
    reward: '500 DATA_PACKETS',
    xp: 500,
    exercises: [
        { id: 'ex_hb', name: 'Heavy Bag', targetSets: 1, targetReps: '10-15 min', previous: '10-15 min' },
        { id: 'ex_ym', name: 'Yoga & Mobility', targetSets: 1, targetReps: '5-10 min', previous: '5-10 min flow' },
    ],
  }
];

// --- HELPER COMPONENTS ---

const Typewriter = ({ text, speed = 30 }) => {
  const [displayedText, setDisplayedText] = useState('');
  useEffect(() => {
    let i = 0;
    setDisplayedText('');
    const intervalId = setInterval(() => {
      if (i < text.length) {
        setDisplayedText(prev => prev + text.charAt(i));
        i++;
      } else {
        clearInterval(intervalId);
      }
    }, speed);
    return () => clearInterval(intervalId);
  }, [text, speed]);
  return <span>{displayedText}<span className="animate-pulse">_</span></span>;
};

// --- MAIN UI COMPONENTS ---

const BBSHeader = ({ operator, onNav }) => (
  <div className="border-2 border-green-500 p-2 font-mono text-green-400 bg-black">
    <div className="flex justify-between items-center border-b-2 border-green-500 pb-1 mb-1">
      <h1 className="text-lg md:text-xl font-bold">[A.E.G.I.S] PROTOCOL</h1>
      <div className="text-xs text-right">
        <div>OPERATOR ID: {operator.id}</div>
        <div>SYS. INTEGRITY: {operator.systemIntegrity}</div>
      </div>
    </div>
    <div className="flex justify-around text-xs md:text-sm">
        <button onClick={() => onNav('board')} className="hover:bg-green-500 hover:text-black p-1">[1] //MSG_BOARD</button>
        <button onClick={() => onNav('profile')} className="hover:bg-green-500 hover:text-black p-1">[2] OPERATOR_PROFILE</button>
        <button className="text-gray-600 p-1 cursor-not-allowed">[3] //BOUNTY_CONTRACTS</button>
        <button className="text-gray-600 p-1 cursor-not-allowed">[4] LOGOUT</button>
    </div>
  </div>
);

const MissionBoard = ({ missions, onSelectMission }) => (
  <div className="p-2 md:p-4">
    <h2 className="text-lg font-bold mb-2 text-green-400">{'>'} INCOMING DIRECTIVES...</h2>
    <div className="space-y-4">
      {missions.map(mission => (
        <div key={mission.id} className="border border-green-500 p-2 bg-black/50">
          <p className="text-green-400 font-bold">{mission.title}</p>
          <p className="text-xs text-gray-400 mb-2">FROM: {mission.from}</p>
          <p className="text-sm mb-2 text-gray-300">{mission.description}</p>
          <div className="flex justify-between items-center">
             <p className="text-xs text-green-400">REWARD: {mission.reward}</p>
             <button onClick={() => onSelectMission(mission.id)} className="bg-green-600 text-black font-bold py-1 px-3 hover:bg-green-400 border border-green-400">
                ACCEPT
             </button>
          </div>
        </div>
      ))}
    </div>
  </div>
);

const OperatorProfile = ({ operator, onNav }) => (
    <div className="p-2 md:p-4">
        <h2 className="text-lg font-bold mb-2 text-green-400">{'>'} OPERATOR_PROFILE [ {operator.id} ]</h2>
        <div className="border border-green-500 p-2 bg-black/50 space-y-2">
            <div>
                <p className="text-green-400">LEVEL:</p>
                <p className="text-white text-xl ml-4">{operator.level}</p>
            </div>
            <div>
                <p className="text-green-400">DATA PACKETS (XP):</p>
                <div className="w-full bg-gray-800 border border-green-500 my-1">
                    <div className="bg-green-500 text-xs font-medium text-black text-center p-0.5 leading-none" style={{width: `${(operator.xp / operator.xpToNextLevel) * 100}%`}}>
                        {operator.xp} / {operator.xpToNextLevel}
                    </div>
                </div>
            </div>
            <div>
                <p className="text-green-400">AUGMENTATIONS:</p>
                <ul className="list-disc list-inside ml-4 text-green-400">
                    {operator.augments.map((aug, index) => (
                        <li key={index}>{aug}</li>
                    ))}
                </ul>
            </div>
             <p className="text-xs text-gray-500 mt-4">// More detailed stats and schematics coming in v1.1</p>
        </div>
         <button onClick={() => onNav('board')} className="mt-4 bg-green-600 text-black font-bold py-1 px-3 hover:bg-green-400 border border-green-400">
            &lt; RETURN TO BOARD
         </button>
    </div>
);

// --- WORKOUT LOGGER COMPONENTS ---

const SetLogger = ({ exercise, loggedSets, onLogSet }) => {
    const [reps, setReps] = useState('');
    const [weight, setWeight] = useState('');

    const handleLogSet = (e) => {
        e.preventDefault();
        onLogSet(exercise.id, reps, weight);
        // Clear inputs for next set
        setReps('');
        setWeight('');
    };
    
    return (
        <div className="bg-black/70 p-2 mt-1">
            <div className="grid grid-cols-4 gap-2 text-center text-xs text-green-400 mb-1">
                <div>SET</div>
                <div>PREVIOUS</div>
                <div>WEIGHT</div>
                <div>REPS</div>
            </div>
            {loggedSets.map((set, index) => (
                 <div key={index} className="grid grid-cols-4 gap-2 text-center items-center text-sm mb-1">
                    <div className="text-green-400">[SET {index + 1}]</div>
                    <div className="text-gray-500">-</div>
                    <div className="text-white">{set.weight || '-'} kg</div>
                    <div className="text-white">{set.reps}</div>
                </div>
            ))}
            <form onSubmit={handleLogSet} className="grid grid-cols-4 gap-2 text-center items-center">
                <div className="text-green-400">[SET {loggedSets.length + 1}]</div>
                <div className="text-xs text-gray-400">{exercise.previous}</div>
                <input 
                    type="number" 
                    placeholder="KG" 
                    value={weight}
                    onChange={(e) => setWeight(e.target.value)}
                    className="bg-gray-900 border border-green-500 text-white p-1 w-full text-center font-mono focus:outline-none focus:ring-1 focus:ring-green-500"
                />
                <input 
                    type="number" 
                    placeholder="REPS" 
                    value={reps}
                    onChange={(e) => setReps(e.target.value)}
                    className="bg-gray-900 border border-green-500 text-white p-1 w-full text-center font-mono focus:outline-none focus:ring-1 focus:ring-green-500"
                />
                <button type="submit" className="col-span-4 mt-2 bg-green-600 text-black font-bold py-1 px-2 hover:bg-green-400 border border-green-400">
                    LOG SET {loggedSets.length + 1}
                </button>
            </form>
        </div>
    );
};

const WorkoutLogger = ({ mission, onCompleteMission, onUpdateXp }) => {
    const [expandedExerciseId, setExpandedExerciseId] = useState(mission.exercises[0].id);
    const [sessionSets, setSessionSets] = useState({});
    const [feedback, setFeedback] = useState('// Begin directive.');

    const handleToggleExercise = (exerciseId) => {
        setExpandedExerciseId(currentId => (currentId === exerciseId ? null : exerciseId));
    };

    const handleLogSet = (exerciseId, reps, weight) => {
        if (!reps) {
            setFeedback('// ERROR: Reps value required.');
            setTimeout(() => setFeedback(''), 2000);
            return;
        }
        const newSet = { reps: parseInt(reps), weight: weight ? parseInt(weight) : 0 };
        const currentSets = sessionSets[exerciseId] || [];
        setSessionSets({ ...sessionSets, [exerciseId]: [...currentSets, newSet] });
        const xpGained = Math.floor(newSet.reps * (newSet.weight || 1) * 0.5);
        onUpdateXp(xpGained);
        setFeedback(`// LOGGED: ${reps}x${weight || 0}kg. +${xpGained} DATA PACKETS`);
    };

    const allExercisesComplete = mission.exercises.every(ex => (sessionSets[ex.id] || []).length >= ex.targetSets);

    return (
        <div className="p-2 md:p-4">
            <h2 className="text-lg font-bold mb-1 text-red-500 animate-pulse">{'>'}! ACTIVE DIRECTIVE: {mission.title}</h2>
            {feedback && <p className="text-green-400 text-sm h-4 mb-2">{feedback}</p>}
            <div className="border border-red-500 p-2 bg-black/50 space-y-2">
                {mission.exercises.map(exercise => {
                    const loggedSets = sessionSets[exercise.id] || [];
                    const isComplete = loggedSets.length >= exercise.targetSets;
                    const isExpanded = expandedExerciseId === exercise.id;
                    return (
                        <div key={exercise.id} className="border-b border-gray-700 pb-2">
                            <div className="flex justify-between items-center cursor-pointer" onClick={() => handleToggleExercise(exercise.id)}>
                                <div>
                                    <p className={`text-lg ${isExpanded ? 'text-green-400' : 'text-white'}`}>{exercise.name}</p>
                                    <p className="text-xs text-gray-400">TARGET: {exercise.targetSets} sets of {exercise.targetReps} reps</p>
                                </div>
                                <div className="text-right">
                                    <p className={`font-bold ${isComplete ? 'text-green-400' : 'text-gray-500'}`}>
                                        {loggedSets.length}/{exercise.targetSets} SETS {isComplete ? '[OK]' : ''}
                                    </p>
                                    <p className="text-green-400 text-xl">{isExpanded ? '[-]' : '[+]'}</p>
                                </div>
                            </div>
                            {isExpanded && <SetLogger exercise={exercise} loggedSets={loggedSets} onLogSet={handleLogSet} />}
                        </div>
                    );
                })}
            </div>
            <div className="mt-4">
                <button 
                    onClick={() => onCompleteMission(mission.xp)} 
                    disabled={!allExercisesComplete}
                    className={`w-full font-bold py-2 px-3 border ${allExercisesComplete ? 'bg-red-600 text-white border-red-400 hover:bg-red-400 animate-pulse' : 'bg-gray-700 text-gray-500 border-gray-600 cursor-not-allowed'}`}
                >
                    {allExercisesComplete ? 'COMPLETE DIRECTIVE' : 'LOG ALL SETS TO COMPLETE'}
                </button>
            </div>
        </div>
    );
};

// --- MAIN APP COMPONENT ---

function App() {
  const [operator, setOperator] = useState(initialOperatorData);
  const [missions, setMissions] = useState(missionsData);
  const [currentScreen, setCurrentScreen] = useState('board');
  const [activeMission, setActiveMission] = useState(null);
  const [isLoading, setIsLoading] = useState(true);

  useEffect(() => { setTimeout(() => setIsLoading(false), 1500); }, []);

  const handleNavigation = (screen) => { setCurrentScreen(screen); };
  
  const handleSelectMission = (missionId) => {
    const mission = missions.find(m => m.id === missionId);
    setActiveMission(mission);
    setCurrentScreen('logging');
  };

  const handleUpdateXp = useCallback((xpGained) => {
    setOperator(prev => {
        const newXp = prev.xp + xpGained;
        if (newXp >= prev.xpToNextLevel) {
            return {
                ...prev,
                level: prev.level + 1,
                xp: newXp - prev.xpToNextLevel,
                xpToNextLevel: Math.floor(prev.xpToNextLevel * 1.5),
                augments: [...prev.augments, `System Upgrade v${prev.level + 1}`]
            };
        }
        return { ...prev, xp: newXp };
    });
  }, []);

  const handleCompleteMission = useCallback((baseXp) => {
    handleUpdateXp(baseXp);
    if (activeMission && activeMission.reward.includes('SCHEMATIC')) {
        const schematic = activeMission.reward.split('SCHEMATIC: ')[1];
        setOperator(prev => ({ ...prev, augments: [...prev.augments, schematic] }));
    }
    setActiveMission(null);
    setCurrentScreen('board');
  }, [activeMission, handleUpdateXp]);

  const renderScreen = () => {
    switch (currentScreen) {
      case 'profile': return <OperatorProfile operator={operator} onNav={handleNavigation} />;
      case 'logging': return <WorkoutLogger mission={activeMission} onCompleteMission={handleCompleteMission} onUpdateXp={handleUpdateXp} />;
      default: return <MissionBoard missions={missions} onSelectMission={handleSelectMission} />;
    }
  };
  
  if (isLoading) {
      return (
          <div className="bg-black text-green-400 h-screen flex flex-col items-center justify-center font-mono text-lg">
              <p><Typewriter text="CONNECTING TO [A.E.G.I.S] NODE 7..." /></p>
              <p><Typewriter text="ENCRYPTION HANDSHAKE... OK" /></p>
              <p><Typewriter text="BIOMETRIC SYNC... OK" /></p>
          </div>
      )
  }

  return (
    <div className="bg-black text-green-400 min-h-screen font-mono p-2 sm:p-4">
        <div className="max-w-4xl mx-auto bg-black/50 border-4 border-green-500">
            <BBSHeader operator={operator} onNav={handleNavigation} />
            <main className="p-2">
                {renderScreen()}
            </main>
            <footer className="border-t-2 border-green-500 p-1 text-center text-xs text-green-500">
                <p>AEGIS PROTOCOL v1.0 - "Keystroke" | System Status: <span className="text-green-400">NOMINAL</span></p>
            </footer>
        </div>
    </div>
  );
}

ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
